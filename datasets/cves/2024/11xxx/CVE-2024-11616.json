{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-11616",
        "assignerOrgId": "bf992f6a-e49d-4e94-9479-c4cff32c62bc",
        "state": "PUBLISHED",
        "assignerShortName": "Netskope",
        "dateReserved": "2024-11-22T09:18:57.849Z",
        "datePublished": "2024-12-19T09:46:26.770Z",
        "dateUpdated": "2024-12-20T19:43:17.991Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "defaultStatus": "unaffected",
                    "platforms": [
                        "Windows"
                    ],
                    "product": "Endpoint DLP",
                    "vendor": "Netskope Inc.",
                    "versions": [
                        {
                            "status": "affected",
                            "version": "118.0.0; 0"
                        }
                    ]
                }
            ],
            "configurations": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Endpoint DLP product on Windows platform (preferable Windows 10 or below as Windows 11 have kernal level protections against such issue) with admin rights.&nbsp;<br>"
                        }
                    ],
                    "value": "Endpoint DLP product on Windows platform (preferable Windows 10 or below as Windows 11 have kernal level protections against such issue) with admin rights."
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Netskope credits Thomas Brice from Oxford Nanopore Technologies for reporting this flaw."
                }
            ],
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<span style=\"background-color: rgb(255, 255, 255);\">Netskope was made aware of a security vulnerability in Netskope Endpoint DLP’s Content Control Driver where a double-fetch issue leads to heap overflow. The vulnerability arises from the fact that the </span><strong>NumberOfBytes</strong><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;argument to </span><strong>ExAllocatePoolWithTag</strong><span style=\"background-color: rgb(255, 255, 255);\">, and the Length argument for </span><strong>RtlCopyMemory</strong><span style=\"background-color: rgb(255, 255, 255);\">, both independently dereference their value from the user supplied input buffer inside the </span><strong>EpdlpSetUsbAction</strong><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;function, known as a double-fetch. If this length value grows to a higher value in between these two calls, it will result in the </span><strong>RtlCopyMemory</strong><span style=\"background-color: rgb(255, 255, 255);\">&nbsp;call copying user-supplied memory contents outside the range of the allocated buffer, resulting in a heap overflow. A malicious attacker will need admin privileges to exploit the issue.</span><br><p>This issue affects Endpoint DLP version below R119.&nbsp;</p>"
                        }
                    ],
                    "value": "Netskope was made aware of a security vulnerability in Netskope Endpoint DLP’s Content Control Driver where a double-fetch issue leads to heap overflow. The vulnerability arises from the fact that the NumberOfBytes argument to ExAllocatePoolWithTag, and the Length argument for RtlCopyMemory, both independently dereference their value from the user supplied input buffer inside the EpdlpSetUsbAction function, known as a double-fetch. If this length value grows to a higher value in between these two calls, it will result in the RtlCopyMemory call copying user-supplied memory contents outside the range of the allocated buffer, resulting in a heap overflow. A malicious attacker will need admin privileges to exploit the issue.\nThis issue affects Endpoint DLP version below R119."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-540",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-540 Overread Buffers"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV4_0": {
                        "Automatable": "NOT_DEFINED",
                        "Recovery": "NOT_DEFINED",
                        "Safety": "NOT_DEFINED",
                        "attackComplexity": "HIGH",
                        "attackRequirements": "PRESENT",
                        "attackVector": "LOCAL",
                        "baseScore": 5.6,
                        "baseSeverity": "MEDIUM",
                        "privilegesRequired": "HIGH",
                        "providerUrgency": "NOT_DEFINED",
                        "subAvailabilityImpact": "NONE",
                        "subConfidentialityImpact": "NONE",
                        "subIntegrityImpact": "LOW",
                        "userInteraction": "NONE",
                        "valueDensity": "NOT_DEFINED",
                        "vectorString": "CVSS:4.0/AV:L/AC:H/AT:P/PR:H/UI:N/VC:N/VI:N/VA:H/SC:N/SI:L/SA:N",
                        "version": "4.0",
                        "vulnAvailabilityImpact": "HIGH",
                        "vulnConfidentialityImpact": "NONE",
                        "vulnIntegrityImpact": "NONE",
                        "vulnerabilityResponseEffort": "NOT_DEFINED"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-125",
                            "description": "CWE-125 Out-of-bounds Read",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "bf992f6a-e49d-4e94-9479-c4cff32c62bc",
                "shortName": "Netskope",
                "dateUpdated": "2024-12-19T09:46:26.770Z"
            },
            "references": [
                {
                    "url": "https://www.netskope.com/company/security-compliance-and-assurance/security-advisories-and-disclosures/netskope-security-advisory-nskpsa-2024-003"
                }
            ],
            "solutions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "Netskope has patch the issue with R119 and onwards and have also backported to R117.1.6"
                        }
                    ],
                    "value": "Netskope has patch the issue with R119 and onwards and have also backported to R117.1.6"
                }
            ],
            "source": {
                "advisory": "NSKPASA-2024-003",
                "discovery": "EXTERNAL"
            },
            "title": "Double-fetch heap overflow",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        },
        "adp": [
            {
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2024-12-20T17:28:18.429717Z",
                                "id": "CVE-2024-11616",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "no"
                                    },
                                    {
                                        "Technical Impact": "partial"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2024-12-20T19:43:17.991Z"
                }
            }
        ]
    }
}